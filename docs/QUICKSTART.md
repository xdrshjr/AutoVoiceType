# AutoVoiceType - 快速启动指南

## 环境准备

### 系统要求

- **操作系统**: Windows 10/11
- **Python**: 3.8+
- **内存**: 至少 2GB 可用
- **网络**: 需要联网（调用阿里云API）

### 安装依赖

```bash
# 进入项目目录
cd AutoVoiceType

# 安装Python依赖
pip install -r requirements.txt
```

**注意**: Windows上安装PyAudio可能需要预编译wheel文件。

---

## 首次运行

### 1. 获取API密钥

1. 访问 [阿里云DashScope控制台](https://dashscope.aliyun.com)
2. 注册/登录账号
3. 创建API密钥
4. 复制密钥（保存好，后面会用到）

### 2. 启动应用

```bash
# 方式1: 使用Python直接运行
cd src
python main.py

# 方式2: 使用启动脚本（Windows）
run.bat
```

### 3. 首次配置

应用启动后会自动：

1. **显示欢迎向导**
   ```
   🎉 欢迎使用 AutoVoiceType
   
   说明和配置引导
   
   [确定]
   ```

2. **打开设置窗口**
   - 自动跳转到"基础设置"页
   - "API密钥"输入框等待输入

3. **配置API密钥**
   - 粘贴之前复制的密钥
   - 点击"验证"按钮（可选）
   - 点击"保存"按钮

4. **重新启动应用**
   ```bash
   cd src
   python main.py
   ```

### 4. 开始使用

启动成功后：

```
===========================================================
🚀 AutoVoiceType 已启动
===========================================================
📌 按住【右Ctrl键】开始语音输入
📌 释放【右Ctrl键】结束输入
📌 右键点击托盘图标可打开设置或退出
===========================================================
```

**系统托盘**:
- 绿色图标（或字母M）出现在任务栏右下角
- 右键点击查看菜单

---

## 基本使用

### 语音输入流程

1. **打开任意应用** (记事本、Word、浏览器等)
2. **点击输入框** 将光标定位
3. **按住右Ctrl键** 开始录音
4. **对着麦克风说话** "你好，这是一个测试"
5. **释放右Ctrl键** 停止录音
6. **等待识别** (通常1-2秒)
7. **自动输入** 识别结果自动填入

**提示**:
- ✅ 按住期间持续录音
- ✅ 释放后自动停止
- ✅ 识别结果自动输入到光标位置
- ⚠️ 需要在安静环境下获得最佳效果

### 托盘菜单

右键点击托盘图标：

```
⚙️  设置      - 打开设置窗口
──────────
ℹ️  关于      - 查看应用信息
──────────
❌  退出      - 退出应用（会确认）
```

### 快捷操作

- **双击托盘图标**: 打开设置（可选功能）
- **右Ctrl键**: 语音输入触发键
- **右键菜单**: 配置和管理

---

## 配置调整

### 打开设置

1. 右键点击托盘图标
2. 选择"⚙️ 设置"
3. 设置窗口打开

### 主要配置项

#### 基础设置（必配）

- ✅ **API密钥**: 阿里云DashScope密钥
- **识别模型**: fun-asr-realtime (推荐)
- **日志级别**: INFO (普通用户)
- **开机自启**: 可选

#### 音频设置

- **麦克风**: 选择音频输入设备
- **采样率**: 16000 Hz (推荐)
- **声道数**: 单声道 (推荐)
- **缓冲大小**: 3200 字节 (默认)

#### 输入设置

- **输入方法**: 剪贴板方案 (推荐)
- **字符延迟**: 0.05 秒
- **粘贴延迟**: 0.1 秒
- **恢复剪贴板**: ✅ 勾选

#### 高级设置

- **智能标点**: 可选
- **超时时间**: 30 秒
- **配置管理**: 打开/重置

---

## 常见问题

### Q1: 应用启动失败？

**检查项**:
1. Python版本是否≥3.8
2. 依赖是否全部安装
3. 查看控制台错误信息
4. 检查日志文件：`~/.autovoicetype/logs/`

**解决方法**:
```bash
# 重新安装依赖
pip install -r requirements.txt --upgrade

# 检查Python版本
python --version

# 查看详细错误
cd src
python main.py
```

### Q2: 找不到托盘图标？

**检查项**:
1. 任务栏通知区域设置
2. 是否被隐藏
3. 应用是否正常运行

**解决方法**:
1. 点击任务栏向上箭头 ↑
2. 找到AutoVoiceType图标
3. 设置为"显示图标和通知"

### Q3: 按右Ctrl键没反应？

**检查项**:
1. API密钥是否配置
2. 麦克风是否正常
3. 查看控制台日志

**解决方法**:
```bash
# 检查配置
打开设置 → 基础设置 → 验证API密钥

# 检查麦克风
打开设置 → 音频设置 → 刷新设备列表

# 查看日志
打开设置 → 高级设置 → 打开配置目录 → logs/
```

### Q4: 识别结果不准确？

**优化建议**:
1. **环境**: 选择安静的环境
2. **麦克风**: 使用质量较好的麦克风
3. **距离**: 保持适当的麦克风距离（10-30cm）
4. **语速**: 清晰、适中的语速
5. **发音**: 标准的普通话发音

### Q5: 无法输入到某些应用？

**原因**:
- 部分应用有特殊保护
- 权限不足

**解决方法**:
1. 尝试切换输入方法：
   - 设置 → 输入设置 → 输入方法
   - 尝试不同方案

2. 以管理员权限运行：
   ```bash
   右键 run.bat → 以管理员身份运行
   ```

3. 检查应用兼容性列表

### Q6: 首次运行没显示向导？

**原因**: 配置文件已存在

**解决方法**:
```bash
# 删除配置文件
删除文件: C:\Users\你的用户名\.autovoicetype\config.json

# 重新启动应用
cd src
python main.py
```

---

## 进阶使用

### 自定义配置

#### 方法1: 使用设置界面（推荐）

```
右键托盘图标 → 设置 → 修改配置 → 保存
```

#### 方法2: 直接编辑配置文件

```bash
# 配置文件位置
Windows: C:\Users\你的用户名\.autovoicetype\config.json

# 使用记事本编辑
设置 → 高级设置 → 打开配置文件
```

**配置文件示例**:
```json
{
  "api": {
    "dashscope_api_key": "sk-xxxxxxxxxxxx",
    "model": "fun-asr-realtime"
  },
  "general": {
    "log_level": "INFO"
  }
}
```

### 开机自启动

**方法1: 使用设置（推荐）**
```
设置 → 基础设置 → ✅ 开机自动启动
```

**方法2: 手动添加**
```
1. Win+R → shell:startup
2. 创建快捷方式指向 run.bat
3. 放入启动文件夹
```

### 查看日志

**日志位置**:
```
C:\Users\你的用户名\.autovoicetype\logs\
```

**日志文件**:
```
autovoicetype_20251228.log  # 按日期命名
```

**查看方法**:
```
设置 → 高级设置 → 打开配置目录 → logs/
```

**日志级别调整**:
```
设置 → 基础设置 → 日志级别 → DEBUG/INFO/WARNING/ERROR
```

---

## 性能优化

### 提升识别速度

1. **网络优化**:
   - 使用稳定的网络连接
   - 降低网络延迟

2. **音频参数**:
   - 保持默认采样率 16000 Hz
   - 使用单声道
   - 适当的缓冲大小

3. **系统资源**:
   - 关闭不必要的后台程序
   - 确保充足的内存

### 提升输入速度

1. **输入方法**:
   - 使用"剪贴板方案"（最快）
   
2. **延迟参数**:
   - 适当降低延迟时间
   - 粘贴延迟: 0.05-0.1秒

### 降低资源占用

1. **日志级别**:
   - 设置为 WARNING 或 ERROR
   - 减少日志写入

2. **音频参数**:
   - 降低采样率（如8000Hz）
   - 注意：可能影响识别准确度

---

## 卸载应用

### 完全卸载

1. **退出应用**:
   ```
   右键托盘图标 → 退出
   ```

2. **删除程序文件**:
   ```
   删除整个 AutoVoiceType 目录
   ```

3. **删除配置文件**（可选）:
   ```
   删除: C:\Users\你的用户名\.autovoicetype\
   ```

4. **移除自动启动**（如果设置过）:
   ```
   Win+R → shell:startup
   删除 AutoVoiceType 快捷方式
   ```

---

## 获取帮助

### 文档

- 📘 **完整文档**: `docs/` 目录
- 📖 **项目方案**: `docs/PROJECT_PLAN.md`
- 📋 **任务清单**: `docs/TASK_LIST.md`
- ⚙️ **设置指南**: `docs/SETTINGS_GUIDE.md`

### 日志

- 📁 **日志目录**: `~/.autovoicetype/logs/`
- 📄 **配置文件**: `~/.autovoicetype/config.json`

### 在线资源

- 🌐 **阿里云DashScope**: https://dashscope.aliyun.com
- 📚 **API文档**: https://help.aliyun.com/zh/dashscope/

---

## 快速命令参考

```bash
# 启动应用
cd src && python main.py

# 查看日志
cd ~/.autovoicetype/logs/

# 编辑配置
notepad ~/.autovoicetype/config.json

# 检查依赖
pip list | grep -E "PyQt5|pynput|PyAudio|dashscope"

# 更新依赖
pip install -r requirements.txt --upgrade
```

---

**文档版本**: 1.0  
**最后更新**: 2025-12-28  
**适用版本**: AutoVoiceType 1.0.0

